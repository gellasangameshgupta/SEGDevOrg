<!----------------------------------------------------------------------------
    Page Name       :SEGTS_ExportToExcel
    Purpose         :Export to Excel
    Created By      :RBEI
    Created Date    :Dec 2018
------------------------------------------------------------------------------->
<apex:page standardcontroller="Test_Specification__c" extensions="SEGTS_ListView_MetaData_CTRL" recordSetVar="TestSpecifications"  contentType="charset=UTF-16/application/vnd.ms-excel#TestspecificationSalesForceExport.xls" >
    <apex:form >
        <apex:variable value="{!1}" var="count"/>
        <apex:variable value="{!1}" var="count1"/>
        <apex:pageblock >
            <apex:outputLabel value="Report Generated By" style="font-weight:bold">
                <apex:outputfield value="{!u.Name}"/>
            </apex:outputLabel> <br/>   
            <apex:outputLabel value="Report Generated Date" style="font-weight:bold">
                <apex:outputtext value="{0,date,dd/MM/yyyy}">
                            <apex:param value="{!Today}"/>
                </apex:outputtext>
            </apex:outputLabel>
        </apex:pageblock>
            
        <apex:pageblock title="Filters">
           <apex:pageblocktable value="{!filters}" var="f">
                <apex:column headerValue="SR No">
                    <apex:outputText value="{!FLOOR(count)}"/>
                    <apex:variable value="{!count+1}" var="count"/>
                </apex:column>
               <apex:column >
                    <apex:outputText value="{!f}"/>
                </apex:column>
             </apex:pageblocktable>
         </apex:pageblock>
        <apex:pageblock title="Records">
            <apex:pageblocktable value="{!listTestSpec}" var="li">
                <!--<apex:column>
                      <apex:outputText value="{!FLOOR(count1)}"/>
                      <apex:variable value="{!count1+1}" var="count1"/>
                </apex:column>-->
                <apex:column headerValue="Test Specification Name">
                    <apex:outputfield value="{!li.Name}"/>
                </apex:column>
                <apex:column headerValue="Test Specification Type">
                    <center><apex:outputfield value="{!li.Test_Spec_Type__c}"/></center>
                </apex:column>
                <apex:column headerValue="Version No.">
                    <center><apex:outputfield value="{!li.Version_No__c}"/></center>
                </apex:column>
                <apex:column headerValue="Solenoid">
                    <apex:outputfield value="{!li.Solenoid__c}"/>
                </apex:column>
                <apex:column headerValue="Starter Type">
                    <apex:outputfield value="{!li.Starter_Type__c}"/>
                </apex:column>
                <apex:column headerValue="i">
                    <apex:outputfield value="{!li.i__c}"/>
                </apex:column>
                <apex:column headerValue="NL">
                    <apex:outputfield value="{!li.NB_PDF__c}"/>
                </apex:column>
                <apex:column headerValue="FLS">
                    <apex:outputfield value="{!li.FLS_PDF__c}"/>
                </apex:column>
                <apex:column headerValue="Additional Features">
                    <apex:outputfield value="{!li.Additional_Features__c}"/>
                </apex:column>
                <apex:column headerValue="Information">
                    <apex:outputfield value="{!li.Information__c}"/>
                </apex:column>
                <apex:column headerValue="SAP Doc">
                    <apex:outputfield value="{!li.SAP_Doc__c}"/>
                </apex:column>
                <apex:column headerValue="Stand">
                    <apex:outputfield value="{!li.Stand__c}"/>
                </apex:column>
                <apex:column headerValue="Condition">
                    <apex:outputfield value="{!li.Condition__c}"/>
                </apex:column>
                <apex:column headerValue="Designation">
                    <apex:outputfield value="{!li.Designation__c}"/>
                </apex:column>
                <apex:column headerValue="Created Date">
                    <apex:outputfield value="{!li.createddate}"/>
                </apex:column>
             </apex:pageblocktable>
         </apex:pageblock>
     </apex:form>               
  
</apex:page>